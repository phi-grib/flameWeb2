<div class="row" *ngIf="this.modelDocumentation !== undefined">
    <div class="card w-100" style="width: 18rem;">

        <div id="overlay" *ngIf="!this.documentationVisible">
            <div class="spinner-border text-etransafe" style="width: 10rem; height: 10rem;" role="status">
                <span class="sr-only">Loading...</span>
            </div>
        </div>

        <div class="accordion" id="docAccordion" *ngIf="this.documentationVisible">


            <!-- block level 1 start -->
            <div class="card">
                <div class="card-header collapsed" id="headingOneDoc" data-toggle="collapse" data-target="#collapseOneDoc" aria-expanded="false" aria-controls="collapseOneDoc">
                    <h5 class="mb-0">
                        General model information <span class=comment>({{this.modelID}})</span>
                        <button class="btn btn-link pt-0 pb-0 float-right" type="button">
                        </button>
                    </h5>
                </div>

                <div id="collapseOneDoc" class="collapse" aria-labelledby="headingOneDoc" data-parent="#docAccordion">
                    <div class="card-body pt-0 pb-0 pl-0 pr-0">

                        <table class="table documentation">
                            <thead>
                                <tr style="vertical-align: middle;">
                                    <th style="width: 25%"><button type="button" *ngIf="this.globals.read_only == false" 
                                                                   class="btn btn-sm btn-outline-primary ml-2" data-toggle="modal" (click)=editSection(0) data-target="#docSection">Edit</button></th>
                                    <th style="width: 60%">Value</th>
                                    <th style="width: 15%" class="text-right">Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let key of this.docLevel[0]">
                                    <td>{{this.cleanStr(key)}}</td>

                                    <td class="doc-value" *ngIf="this.modelDocumentation[key].value && !isObject(this.modelDocumentation[key].value)">
                                        {{this.modelDocumentation[key].value}}</td>
                                    <td *ngIf="this.modelDocumentation[key].value && isObject(this.modelDocumentation[key].value)">

                                        <table class="table" style="table-layout: fixed; width: 100%" id="documentationTable">
                                            <tbody>
                                                <tr *ngFor="let key2 of this.objectKeys(this.modelDocumentation[key].value)">
                                                    <td style="width: 25%">{{this.cleanStr(key2)}}</td>

                                                    <td style="width: 50%; word-wrap: break-word" class="doc-value" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].value}}</td>
                                                    <td style="width: 50%" class="doc-value" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2]}}</td>

                                                    <td style="width: 25%" class="text-right comment" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].description}}
                                                    </td>
                                                    <td style="width: 25%" class="text-right comment" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        na</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </td>
                                    <td *ngIf="!this.modelDocumentation[key].value"></td>
                                    <td class="text-right comment">{{this.modelDocumentation[key].description}}</td>

                                </tr>
                            </tbody>
                        </table>


                    </div>
                </div>
            </div>
            <!-- block level 1 end -->

            <!-- block level 2 start -->
            <div class="card">
                <div class="card-header collapsed" id="headingTwoDoc" data-toggle="collapse" data-target="#collapseTwoDoc" aria-expanded="false" aria-controls="collapseTwoDoc">
                    <h5 class="mb-0">
                        Algorithm and software
                        <button class="btn btn-link pt-0 pb-0 float-right" type="button">
                        </button>
                    </h5>
                </div>

                <div id="collapseTwoDoc" class="collapse" aria-labelledby="headingTwoDoc" data-parent="#docAccordion">
                    <div class="card-body pt-0 pb-0 pl-0 pr-0">

                        <table class="table documentation">
                            <thead>
                                <tr style="vertical-align: middle;">
                                    <th style="width: 25%"><button type="button" *ngIf="this.globals.read_only == false" 
                                                                   class="btn btn-sm btn-outline-primary ml-2" data-toggle="modal" (click)=editSection(1) data-target="#docSection">Edit</button></th>
                                    <th style="width: 60%">Value</th>
                                    <th style="width: 15%" class="text-right">Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let key of this.docLevel[1]">
                                    <td>{{this.cleanStr(key)}}</td>

                                    <td class="doc-value" *ngIf="this.modelDocumentation[key].value && !isObject(this.modelDocumentation[key].value)">
                                        {{this.modelDocumentation[key].value}} </td>
                                    <td *ngIf="this.modelDocumentation[key].value && isObject(this.modelDocumentation[key].value)">

                                        <table class="table" style="table-layout: fixed; width: 100%" id="documentationTable">
                                            <tbody>
                                                <tr *ngFor="let key2 of this.objectKeys(this.modelDocumentation[key].value)">
                                                    <!-- <td style="width: 25%">{{this.cleanStr(this.cleanFit(key2))}}</td> -->
                                                    <td style="width: 25%">{{this.cleanStr(key2)}}</td>

                                                    <td style="width: 50%; word-wrap: break-word" class="doc-value" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].value}}</td>

                                                    <td style="width: 25%" class="text-right comment" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].description}}
                                                    </td>

                                                    <td style="width: 50%" class="doc-value" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2]}}</td>

                                                    <td style="width: 25%" class="text-right comment" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        na</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </td>
                                    <td *ngIf="!this.modelDocumentation[key].value"></td>
                                    <td class="text-right comment">{{this.modelDocumentation[key].description}}</td>

                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>
            <!-- block level 2 end -->

            <!-- block level 3 start -->
            <div class="card">
                <div class="card-header collapsed" id="headingThreeDoc" data-toggle="collapse" data-target="#collapseThreeDoc" aria-expanded="false" aria-controls="collapseThreeDoc">
                    <h5 class="mb-0">
                        Other information
                        <button class="btn btn-link pt-0 pb-0 float-right" type="button">
                        </button>
                    </h5>
                </div>

                <div id="collapseThreeDoc" class="collapse" aria-labelledby="headingThreeDoc" data-parent="#docAccordion">
                    <div class="card-body pt-0 pb-0 pl-0 pr-0">

                        <table class="table documentation">
                            <thead>
                                <tr style="vertical-align: middle;">
                                    <th style="width: 25%"><button type="button" *ngIf="this.globals.read_only == false" 
                                                                   class="btn btn-sm btn-outline-primary ml-2" data-toggle="modal" (click)=editSection(2) data-target="#docSection">Edit</button></th>
                                    <th style="width: 60%">Value</th>
                                    <th style="width: 15%" class="text-right">Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let key of this.docLevel[2]">
                                    <td>{{this.cleanStr(key)}}</td>

                                    <td class="doc-value" *ngIf="this.modelDocumentation[key].value && !isObject(this.modelDocumentation[key].value)">
                                        {{this.modelDocumentation[key].value}}</td>
                                    <td *ngIf="this.modelDocumentation[key].value && isObject(this.modelDocumentation[key].value)">

                                        <table class="table"  style="table-layout: fixed; width: 100%" id="documentationTable">
                                            <tbody>
                                                <tr *ngFor="let key2 of this.objectKeys(this.modelDocumentation[key].value)">
                                                    <td style="width: 25%">{{this.cleanStr(key2)}}</td>

                                                    <td style="width: 50%; word-wrap: break-word" class="doc-value" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].value}}</td>
                                                    <td style="width: 50%" class="doc-value" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2]}}</td>

                                                    <td style="width: 25%" class="text-right comment" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                        {{this.modelDocumentation[key].value[key2].description}}
                                                    </td>
                                                    <td style="width: 25%" class="text-right comment" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                        na</td>
                                                </tr>
                                            </tbody>
                                        </table>

                                    </td>
                                    <td *ngIf="!this.modelDocumentation[key].value"></td>
                                    <td class="text-right comment">{{this.modelDocumentation[key].description}}</td>

                                </tr>
                            </tbody>
                        </table>

                    </div>
                </div>
            </div>



        </div>
        <div class="card">
            <div class="card-header collapsed" id="headingThreeDoc" data-toggle="collapse" data-target="#exportImport" aria-expanded="false" aria-controls="collapseThreeDoc">
                <h5 class="mb-0">
                    Export/Import
                    <button class="btn btn-link pt-0 pb-0 float-right" type="button">
                </button>
                </h5>
            </div>
            <div id="exportImport" class="collapse" aria-labelledby="headingThreeDoc" data-parent="#docAccordion">
                <div class="card-body pt-0 pb-0 pl-0 pr-0">
                    <div class="btn-toolbar mt-3 mb-3 ml-4" role="toolbar" aria-label="Toolbar import/export">

                        Documentation:

                        <!-- <div class="btn-group ml-2" role="group" aria-label="group1">
                            <button class="btn btn-ets-down ml-2" (click)="downloadFile()" [ngClass]="{'disabled': model.name === undefined}">Download Yaml</button>
                            <button class="btn btn-ets-down ml-2" (click)="downloadWord()" [ngClass]="{'disabled': model.name === undefined}">Download Word</button>
                            <button class="btn btn-ets-down ml-2" (click)="downloadExcel()" [ngClass]="{'disabled': model.name === undefined}">Download Excel</button>
                        </div> -->
                        
                        <div class="btn-group ml-2" role="group" aria-label="group1">
                            <button id="btnGroupDrop1" type="button" class="btn btn-ets-down dropdown-toggle ml-2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Download
                            </button>
                            <div class="dropdown-menu column" aria-labelledby="btnGroupDrop1">
                                <button type="button" class="dropdown-item btn btn-ets-down ml-2" data-toggle="modal" (click)="downloadFile()" [ngClass]="{'disabled': model.name === undefined}">YAML</button>
                                <button type="button" class="dropdown-item btn btn-ets-down ml-2" data-toggle="modal" (click)="downloadWord()" [ngClass]="{'disabled': model.name === undefined}">Word</button>
                                <button type="button" class="dropdown-item btn btn-ets-down ml-2" data-toggle="modal" (click)="downloadExcel()" [ngClass]="{'disabled': model.name === undefined}">Excel</button>
                            </div> 
                        </div>


                        <div class="btn-group ml-2 pr-5" role="group" aria-label="group2">
                            <label class="btn btn-ets-up mb-0" for="uploadButton">
                                   <input id="uploadButton" type="file" style="display:none;" (change)="uploadFile($event)" accept="text/yml, text/yaml">Upload
                            </label>
                        </div>

                        Series:

                        <div class="btn-group ml-2 pr-5" role="group" aria-label="group3">
                            <button class="btn btn-ets-down ml-2" (click)="downloadSeries()" [ngClass]="{'disabled': model.name === undefined || model.secret}">Download</button>
                        </div>

                        Parameters:

                        <div class="btn-group ml-2" role="group" aria-label="group4">
                            <button class="btn btn-ets-down ml-2" (click)="downloadParameters()" [ngClass]="{'disabled': model.name === undefined}">Download</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- New Model -->
<div class="modal fade" id="docSection" tabindex="-1" role="dialog" aria-labelledby="docSectionLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title" id="docSectionLabel">Documentation editor for section {{this.levelLabels[this.sectionActive]}}
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>

            <div class="modal-body">
                <div *ngFor="let key of this.editLevel[this.sectionActive]">
                    <!-- non objects -->
                    <div class="form-group row" *ngIf="!isObject(this.modelDocumentation[key].value)">
                        <div class="col-8">
                            <input class="form-control doc-value" [(ngModel)]="this.modelDocumentation[key].value" data-toggle="tooltip" data-placement="top" title="{{this.cleanStr(key)}}" id="#key" type='text-area' placeholder="{{this.cleanStr(key)}}">
                        </div>
                        <label for=key class="col-4 text-muted small pl-0">{{this.modelDocumentation[key].description}}</label>
                    </div>

                    <div class="form-group row" *ngIf="isObject(this.modelDocumentation[key].value)">
                        <div class="col-12 col-sm-12">
                            <div class="row">
                                <div class="col-2 col-sm-2">
                                    <label for=key class="small pl-0">{{this.cleanStr(key)}}</label>
                                </div>

                                <div class="col-8 col-sm-10">
                                    <div *ngFor="let key2 of this.objectKeys(this.modelDocumentation[key].value)">
                                        <div class="row">
                                            <input class="col-sm-7 form-control doc-value-inner" *ngIf="isObject(this.modelDocumentation[key].value[key2])" [(ngModel)]="this.modelDocumentation[key].value[key2].value" data-toggle="tooltip" data-placement="top" title="{{this.cleanStr(key+' : '+key2)}}"
                                                id="key2" type='text-area' placeholder="{{this.cleanStr(key2)}}">

                                            <input class="col-sm-7 form-control doc-value-inner" *ngIf="!isObject(this.modelDocumentation[key].value[key2])" [(ngModel)]="this.modelDocumentation[key].value[key2]" data-toggle="tooltip" data-placement="top" title="{{this.cleanStr(key+' : '+key2)}}"
                                                id="key2" type='text-area' placeholder="{{this.cleanStr(key2)}}">

                                            <label for=key class="col-sm-3 text-muted small" *ngIf="isObject(this.modelDocumentation[key].value[key2])">
                                                {{this.modelDocumentation[key].value[key2].description}}</label>
                                            <label for=key class="col-sm-3 text-muted small" *ngIf="!isObject(this.modelDocumentation[key].value[key2])">
                                                na</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="this.cancelInput()">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="this.applyInput()">Apply</button>
            </div>

        </div>
    </div>
</div>